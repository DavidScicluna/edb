"use strict";(self.webpackChunkedb=self.webpackChunkedb||[]).push([[569],{14569:function(e,t,n){n.r(t);var i=n(70442),r=n(95292),o=n(13556),a=n(34245),s=n(52326),u=n(23031),c=n.n(u),l=n(5411),d=n(83558),g=n(51661),v=n(64475),h=n(74001),p=n(74787),f=n(11330),Z=n(97924),m=n(96802),x=n(54220),_=n.n(x),y=n(51982),b=n.n(y),j=n(54290),k=n.n(j),P=n(44231),S=n.n(P),w=n(49836),E=n.n(w),C=n(93178),T=n.n(C),F=n(15484),B=n.n(F),L=n(7064),N=n.n(L),O=n(17696),D=n.n(O),M=n(46478),U=n.n(M),Y=n(78293),R=n(91775),W=n(11382),q=n(68612),z=n(12363),H=n(13857),I=n(87765),J=n(67079),Q=n(86662),V=n(63516),A=n(7699),G=n(81745),K=n(31133),X=n(15533),$=n(3670),ee=n(60334),te=n(63304),ne={language:"en-US",ott_region:"US",certification_country:"US","primary_release_date.lte":b()().format("YYYY-MM-DD")};t.default=function(){var e,t=_().CancelToken.source(),n=(0,p.ac)("(max-width: 600px)"),u=(0,s.Z)(n,1)[0],x=(0,v.TH)(),y=(0,h.lr)(ne),b=(0,s.Z)(y,2),j=b[0],P=b[1],w=(0,q.v9)((function(e){var t;return(null===(t=(0,ee.PR)(e.users.data.users,e.app.data.user))||void 0===t?void 0:t.ui.theme.color)||ee.Bt.ui.theme.color})),C=(0,R.h4)(),F=(0,s.Z)(C,2),L=F[0],O=F[1].height,M=(0,l.useState)(),ie=(0,s.Z)(M,2),re=ie[0],oe=ie[1],ae=(0,f.kt)(),se=(0,s.Z)(ae,2),ue=se[0],ce=se[1],le=(0,l.useState)(0),de=(0,s.Z)(le,2),ge=de[0],ve=de[1],he=(0,g.useInfiniteQuery)("movies",function(){var e=(0,a.Z)(c().mark((function e(n){var i,r,a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.pageParam,r=void 0===i?1:i,e.next=3,z.Z.get("/discover/movie",{params:(0,o.Z)((0,o.Z)({},Y.parse(j.toString()||"")||{}),{},{page:r||1}),cancelToken:t.token}).then((function(e){return(0,z.t)(ue?0:2500,e)}));case 3:return a=e.sent,s=a.data,e.abrupt("return",s);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{enabled:!1,getPreviousPageParam:function(e){return 1!==e.page&&((null===e||void 0===e?void 0:e.page)||0)-1},getNextPageParam:function(e){return e.page!==e.total_pages&&((null===e||void 0===e?void 0:e.page)||0)+1},onSuccess:function(e){var t=[];e.pages.forEach((function(e){t=[].concat((0,r.Z)(t),(0,r.Z)((null===e||void 0===e?void 0:e.results)||[]))})),oe({page:e.pages[e.pages.length-1].page,results:(0,r.Z)(U()(t,"id")),total_pages:e.pages[e.pages.length-1].total_pages,total_results:e.pages[e.pages.length-1].total_results})}}),pe=(0,l.useCallback)(k()((function(e){var t,n=0;for(t in e)("dates"!==t||(E()(e.dates.gte)||S()(e.dates.gte))&&(E()(e.dates.lte)||S()(e.dates.lte)))&&("dates"===t||E()(e[t])||S()(e[t]))||(n+=1);ve(n)}),500),[ve]),fe=function(e){var t=Y.parse(j.toString()||"");Object.keys(t).forEach((function(e){return"sort_by"===e||delete t[e]}));var n=D()(T()((0,o.Z)((0,o.Z)({},ne),{},{certification:e.certifications.length>0?e.certifications.join("|"):void 0,"primary_release_date.gte":e.dates.gte||void 0,"primary_release_date.lte":e.dates.lte||void 0,with_genres:e.genres.length>0?e.genres.join(","):void 0,"vote_average.gte":e.rating.length>0&&e.rating[0]?e.rating[0]:void 0,"vote_average.lte":e.rating.length>0&&e.rating[1]?e.rating[1]:void 0,"vote_count.gte":e.count.length>0&&e.count[0]?e.count[0]:void 0,"vote_count.lte":e.count.length>0&&e.count[1]?e.count[1]:void 0,"with_runtime.gte":e.runtime.length>0&&e.runtime[0]?e.runtime[0]:void 0,"with_runtime.lte":e.runtime.length>0&&e.runtime[1]?e.runtime[1]:void 0})),E()||S());P(B()((0,o.Z)((0,o.Z)({},t),n))),setTimeout((function(){return he.refetch()}),250)};return(0,l.useEffect)((function(){pe((0,V.J)(x.search,"movie"))}),[x.search]),(0,R.rf)((function(){var e=Y.parse(x.search),t=e&&e.page&&"string"===typeof e.page?Number(e.page):1;((null===re||void 0===re?void 0:re.page)||1)<t&&he.hasNextPage&&(ce.on(),he.fetchNextPage())}),[null===re||void 0===re?void 0:re.page]),(0,R.qR)((function(){var e=Y.parse(x.search);P(Object.keys(e).length>0?T()((0,o.Z)((0,o.Z)({},ne),e)):T()((0,o.Z)((0,o.Z)({},ne),{},{sort_by:"popularity.desc"}))),setTimeout((function(){return he.refetch()}),250)})),(0,l.useEffect)((function(){return function(){return t.cancel()}}),[]),(0,te.jsx)($.Z,{title:"Movies",children:{actions:(0,te.jsxs)(Z.Ug,{width:u?"100%":"auto",spacing:2,children:[(0,te.jsx)(K.Z,{renderButton:function(e){var t=e.color,n=e.onClick;return(0,te.jsx)(I.Z,{color:t,isFullWidth:u,isDisabled:he.isFetching||he.isLoading||he.isError,onClick:n,variant:"outlined",sx:{back:{height:"".concat(O,"px")}},children:"Sort By"})},sortBy:(0,r.Z)(X.Y),onSort:function(e){var t=N()(Y.parse(j.toString()||""),"sort_by"),n={sort_by:"".concat(e.sortBy.value,".").concat(e.direction)};P(B()((0,o.Z)((0,o.Z)({},t),n))),setTimeout((function(){return he.refetch()}),250)}}),(0,te.jsx)(G.Z,{renderButton:function(e){var t=e.color,n=e.onClick;return(0,te.jsx)(I.Z,{color:t,renderRight:ge>0?function(e){var t=e.color;return(0,te.jsx)(m.pT,{in:!0,unmountOnExit:!0,children:(0,te.jsx)(H.Z,{color:t,size:"xs",children:(0,te.jsx)(d.ZP,{duration:1,end:ge})})})}:void 0,isFullWidth:u,isDisabled:he.isFetching||he.isLoading||he.isError,onClick:n,variant:"outlined",sx:{back:{height:"".concat(O,"px")}},children:"Filter"})},mediaType:"movie",onFilter:fe}),(0,te.jsx)(J.Z,{ref:L})]}),body:(0,te.jsxs)(Z.gC,{width:"100%",spacing:4,px:2,pt:2,children:[(0,te.jsxs)(Z.gC,{width:"100%",spacing:2,children:[(0,te.jsx)(m.UO,{in:ge>0,unmountOnExit:!0,style:{width:"100%"},children:(0,te.jsx)(A.Z,{mediaType:"movie",onTagDelete:function(e,t){return fe((0,o.Z)((0,o.Z)({},t),{},(0,i.Z)({},e,G.P[e])))},onClear:function(){return fe((0,o.Z)({},G.P))}})}),(0,te.jsx)(W.Z,{isError:he.isError,isSuccess:he.isSuccess,isLoading:he.isFetching||he.isLoading,movies:(null===re||void 0===re?void 0:re.results)||[]})]}),(0,te.jsx)(m.MT,{in:!he.isError&&((null===re||void 0===re?void 0:re.total_results)||0)>0,unmountOnExit:!0,style:{width:u?"100%":"auto"},children:(0,te.jsx)(Q.Z,{color:w,amount:(null===re||void 0===re||null===(e=re.results)||void 0===e?void 0:e.length)||0,total:(null===re||void 0===re?void 0:re.total_results)||0,label:"Movies",isLoading:he.isFetching||he.isLoading,isButtonVisible:(he.hasNextPage,!he.isError),onClick:function(){var e=(null===re||void 0===re?void 0:re.page)||1,t=Y.parse(j.toString()||"");P(B()((0,o.Z)((0,o.Z)({},t),{},{page:e+1}))),ce.on(),setTimeout((function(){return he.fetchNextPage()}),250)}})})]})}})}}}]);
//# sourceMappingURL=569.3430a313.chunk.js.map