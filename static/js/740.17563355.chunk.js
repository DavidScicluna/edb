"use strict";(self.webpackChunkedb=self.webpackChunkedb||[]).push([[740],{6740:function(e,t,n){n.r(t);var i=n(56729),r=n(43583),o=n(94869),a=n(26664),s=n(61895),u=n(75231),c=n.n(u),l=n(41484),g=n(67770),d=n(97417),h=n(86617),v=n(75019),p=n(7300),f=n(66289),m=n(20347),Z=n(11557),x=n(14539),y=n.n(x),_=n(10514),b=n.n(_),j=n(54431),k=n.n(j),E=n(6842),S=n(23890),w=n(21805),P=n(50762),C=n(54915),T=n(89782),N=n(82115),B=n(96981),F=n(18658),L=n(30122),O=n(97316),D=n(5625),M=n(95690),U=n(87929),W=n(8771),Y={language:"en-US",ott_region:"US",certification_country:"US","primary_release_date.lte":k()().format("YYYY-MM-DD")};t.default=function(){var e,t=y().CancelToken.source(),n=(0,p.ac)("(max-width: 600px)"),u=(0,s.Z)(n,1)[0],x=(0,h.TH)(),_=(0,v.lr)(Y),j=(0,s.Z)(_,2),k=j[0],q=j[1],R=(0,S.h4)(),z=(0,s.Z)(R,2),H=z[0],I=z[1].height,J=(0,l.useState)(),Q=(0,s.Z)(J,2),V=Q[0],A=Q[1],G=(0,f.kt)(),K=(0,s.Z)(G,2),X=K[0],$=K[1],ee=(0,l.useState)(0),te=(0,s.Z)(ee,2),ne=te[0],ie=te[1],re=(0,d.useInfiniteQuery)("movies",function(){var e=(0,a.Z)(c().mark((function e(n){var i,r,a,s;return c().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=n.pageParam,r=void 0===i?1:i,e.next=3,P.Z.get("/discover/movie",{params:(0,o.Z)((0,o.Z)({},E.parse(k.toString()||"")||{}),{},{page:r||1}),cancelToken:t.token}).then((function(e){return(0,P.t)(X?0:2500,e)}));case 3:return a=e.sent,s=a.data,e.abrupt("return",s);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),{enabled:!1,getPreviousPageParam:function(e){return 1!==e.page&&((null===e||void 0===e?void 0:e.page)||0)-1},getNextPageParam:function(e){return e.page!==e.total_pages&&((null===e||void 0===e?void 0:e.page)||0)+1},onSuccess:function(e){var t=[];e.pages.forEach((function(e){t=[].concat((0,r.Z)(t),(0,r.Z)((null===e||void 0===e?void 0:e.results)||[]))})),A({page:e.pages[e.pages.length-1].page,results:(0,r.Z)(b().uniqBy(t,"id")),total_pages:e.pages[e.pages.length-1].total_pages,total_results:e.pages[e.pages.length-1].total_results})}}),oe=(0,l.useCallback)(b().debounce((function(e){var t,n=0;for(t in e)("dates"!==t||(b().isNil(e.dates.gte)||b().isEmpty(e.dates.gte))&&(b().isNil(e.dates.lte)||b().isEmpty(e.dates.lte)))&&("dates"===t||b().isNil(e[t])||b().isEmpty(e[t]))||(n+=1);ie(n)}),500),[ie]),ae=function(e){var t=E.parse(k.toString()||"");Object.keys(t).forEach((function(e){return"sort_by"===e||delete t[e]}));var n=b().omitBy(b().merge((0,o.Z)((0,o.Z)({},Y),{},{certification:e.certifications.length>0?e.certifications.join("|"):void 0,"primary_release_date.gte":e.dates.gte||void 0,"primary_release_date.lte":e.dates.lte||void 0,with_genres:e.genres.length>0?e.genres.join(","):void 0,"vote_average.gte":e.rating.length>0&&e.rating[0]?e.rating[0]:void 0,"vote_average.lte":e.rating.length>0&&e.rating[1]?e.rating[1]:void 0,"vote_count.gte":e.count.length>0&&e.count[0]?e.count[0]:void 0,"vote_count.lte":e.count.length>0&&e.count[1]?e.count[1]:void 0,"with_runtime.gte":e.runtime.length>0&&e.runtime[0]?e.runtime[0]:void 0,"with_runtime.lte":e.runtime.length>0&&e.runtime[1]?e.runtime[1]:void 0})),b().isNil||b().isEmpty);q(b().mergeWith((0,o.Z)((0,o.Z)({},t),n))),setTimeout((function(){return re.refetch()}),250)};return(0,l.useEffect)((function(){oe((0,F.J)(x.search,"movie"))}),[x.search]),(0,S.rf)((function(){var e=E.parse(x.search),t=e&&e.page&&"string"===typeof e.page?Number(e.page):1;((null===V||void 0===V?void 0:V.page)||1)<t&&re.hasNextPage&&($.on(),re.fetchNextPage())}),[null===V||void 0===V?void 0:V.page]),(0,S.qR)((function(){var e=E.parse(x.search);q(Object.keys(e).length>0?b().merge((0,o.Z)((0,o.Z)({},Y),e)):b().merge((0,o.Z)((0,o.Z)({},Y),{},{sort_by:"popularity.desc"}))),setTimeout((function(){return re.refetch()}),250)})),(0,l.useEffect)((function(){return function(){return t.cancel()}}),[]),(0,W.jsx)(U.Z,{title:"Movies",children:{actions:(0,W.jsxs)(m.Ug,{width:u?"100%":"auto",spacing:2,children:[(0,W.jsx)(D.Z,{renderButton:function(e){var t=e.color,n=e.onClick;return(0,W.jsx)(T.Z,{color:t,isFullWidth:u,isDisabled:re.isFetching||re.isLoading||re.isError,onClick:n,variant:"outlined",sx:{back:{height:"".concat(I,"px")}},children:"Sort By"})},sortBy:(0,r.Z)(M.Y),onSort:function(e){var t=b().omit(E.parse(k.toString()||""),"sort_by"),n={sort_by:"".concat(e.sortBy.value,".").concat(e.direction)};q(b().mergeWith((0,o.Z)((0,o.Z)({},t),n))),setTimeout((function(){return re.refetch()}),250)}}),(0,W.jsx)(O.Z,{renderButton:function(e){var t=e.color,n=e.onClick;return(0,W.jsx)(T.Z,{color:t,renderRight:ne>0?function(e){var t=e.color;return(0,W.jsx)(Z.pT,{in:!0,unmountOnExit:!0,children:(0,W.jsx)(C.Z,{color:t,size:"xs",children:(0,W.jsx)(g.ZP,{duration:1,end:ne})})})}:void 0,isFullWidth:u,isDisabled:re.isFetching||re.isLoading||re.isError,onClick:n,variant:"outlined",sx:{back:{height:"".concat(I,"px")}},children:"Filter"})},mediaType:"movie",onFilter:ae}),(0,W.jsx)(N.Z,{ref:H})]}),body:(0,W.jsxs)(m.gC,{width:"100%",spacing:4,px:2,pt:2,children:[(0,W.jsxs)(m.gC,{width:"100%",spacing:2,children:[(0,W.jsx)(Z.UO,{in:ne>0,unmountOnExit:!0,style:{width:"100%"},children:(0,W.jsx)(L.Z,{mediaType:"movie",onTagDelete:function(e,t){return ae((0,o.Z)((0,o.Z)({},t),{},(0,i.Z)({},e,O.P[e])))},onClear:function(){return ae((0,o.Z)({},O.P))}})}),(0,W.jsx)(w.Z,{isError:re.isError,isSuccess:re.isSuccess,isLoading:re.isFetching||re.isLoading,movies:(null===V||void 0===V?void 0:V.results)||[]})]}),(0,W.jsx)(Z.MT,{in:!re.isError&&((null===V||void 0===V?void 0:V.total_results)||0)>0,unmountOnExit:!0,style:{width:u?"100%":"auto"},children:(0,W.jsx)(B.Z,{amount:(null===V||void 0===V||null===(e=V.results)||void 0===e?void 0:e.length)||0,total:(null===V||void 0===V?void 0:V.total_results)||0,label:"Movies",isLoading:re.isFetching||re.isLoading,isButtonVisible:(re.hasNextPage,!re.isError),onClick:function(){var e=(null===V||void 0===V?void 0:V.page)||1,t=E.parse(k.toString()||"");q(b().mergeWith((0,o.Z)((0,o.Z)({},t),{},{page:e+1}))),$.on(),setTimeout((function(){return re.fetchNextPage()}),250)}})})]})}})}}}]);
//# sourceMappingURL=740.17563355.chunk.js.map