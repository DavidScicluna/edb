import{d6 as oe,d7 as I,d8 as L,dR as re,b6 as Z,cW as A,cX as G,b7 as m,aL as ae,a6 as te,x as ie,E as e,cY as ne,bI as de,N as b,V as y,as as q,bO as le,ah as E,J as ce,cB as S,aj as M,ai as W,bz as ue,L as pe,aQ as z,H as he,I as me,a7 as we,a9 as fe,af as be,aa as Ce,c9 as Pe,U as ge,c7 as ve,cV as Ie,c1 as ye,db as Se,dS as Me,dT as B,M as xe,ch as j,ci as X,dd as Ve}from"./useUserTheme-cad0e91d.js";import{u as He,P as T,s as Y}from"./index-5536e45c.js";import{I as Ne}from"./index-7c3284f8.js";import{u as $e}from"./usePrompt-5bc04cbc.js";import{r as ke}from"./index-789eed9b.js";import"./index-f91c493c.js";import"./index-8754a0a6.js";import"./index-da6fdb45.js";import"./dimensions-1922ff5f.js";import"./index-490c57f0.js";import"./index-fac269b5.js";import"./index-86281d15.js";import"./index-65752566.js";import"./index-6c03e0d3.js";import"./index-566ac3e3.js";import"./index-059dc8bd.js";import"./index-67fb8a4b.js";import"./index-278c1566.js";import"./index-5e29d59e.js";import"./tabs-1769093c.js";import"./index-c7b185ee.js";import"./index-a6d2ef26.js";import"./index-6b3e9b0b.js";import"./tabs-8cea7072.js";const Oe=oe().shape({username:I().required().label("Username"),password:I().required().matches(/^(?=.*[A-Za-z])(?=.*\d)(?=.*[@$!%*#?&])[A-Za-z\d@$!%*#?&]{8,}$/,"Must Contain 8 Characters, One Uppercase, One Lowercase, One Number and one special case Character!").max(30,"Cannot exceed 30 chars!").label("Password"),newPassword:I().required().matches(/^(?=.*[A-Za-z])(?=.*\d)(?=.*[@$!%*#?&])[A-Za-z\d@$!%*#?&]{8,}$/,"Must Contain 8 Characters, One Uppercase, One Lowercase, One Number and one special case Character!").max(30,"Cannot exceed 30 chars!").notOneOf([L("password")],"New password must not be equal to Password!").label("New Password"),confirmNewPassword:I().oneOf([L("newPassword")],"Confirm Password must be equal to New Password!").label("Confirm Password")}),P=2,Re=({form:H,onSubmit:g,onBack:N})=>{const{color:p=he,colorMode:r=me}=re(),$=Z(s=>s.users.data.users||[]),{control:i,handleSubmit:t}=H,w=A({control:i,name:"username"}),v=A({control:i,name:"password"}),{isDirty:k}=G({control:i}),[f,U]=m(),[l,O]=m(),[R,D]=m(),[n,C]=m(),[Q,J]=m(),[F,_]=m(),[K,ee]=m(),se=ae(te.sample(He)||"johnsmith");return ie.useEffect(()=>U[w&&$.some(s=>s.data.credentials.username===w)?"on":"off"](),[w]),e(ne,{width:"100%",onSubmit:t(g),children:e(de,{colorMode:r,isFullWidth:!0,p:P,spacing:0,children:b(y,{width:"100%",divider:e(q,{colorMode:r}),spacing:P,children:[e(le,{renderTitle:s=>e(E,{...s,fontSize:"2xl",children:"Reset Password?"}),renderSubtitle:s=>e(E,{...s,noOfLines:0,children:"In order to reset password please enter the username, the current password and the new password!"})}),e(ce,{children:b(y,{width:"100%",divider:e(q,{colorMode:r}),spacing:P,children:[e(S,{control:i,name:"username",render:({field:{onChange:s,onBlur:h,value:c,name:u},fieldState:{error:o}})=>e(M,{color:p,colorMode:r,autoComplete:"off",label:"Username",id:u,name:u,helper:o?o.message:void 0,placeholder:se,onBlur:h,onChange:s,isError:!!o,isFullWidth:!0,isRequired:!0,renderLeftPanel:({color:d,...a})=>e(W,{...a,icon:"alternate_email",category:"outlined",skeletonColor:d}),renderRightPanel:c.length>=5?({color:d,...a})=>e(W,{...a,icon:f?"done":"close",category:"outlined",skeletonColor:d}):void 0,value:c})}),b(y,{width:"100%",divider:e(q,{colorMode:r}),spacing:P,children:[e(S,{control:i,name:"password",render:({field:{onChange:s,onBlur:h,value:c,name:u},fieldState:{error:o}})=>e(M,{color:p,colorMode:r,autoComplete:"off",label:"Current Password",name:u,helper:o?o.message:void 0,placeholder:l?"password":"••••••••",onBlur:h,onChange:s,isDisabled:!f,isError:!!o,isFullWidth:!0,isRequired:!0,renderRightPanel:({color:d,...a})=>e(T,{...a,label:"Current Password",isVisible:l,isHovering:R,setIsVisible:O,setIsHovering:D,iconProps:{...a,skeletonColor:d}}),type:l?"text":"password",value:c})}),b(y,{width:"100%",spacing:P,children:[e(S,{control:i,name:"newPassword",render:({field:{onChange:s,onBlur:h,value:c,name:u},fieldState:{error:o}})=>e(M,{color:p,colorMode:r,autoComplete:"off",label:"New Password",name:u,helper:o?o.message:void 0,placeholder:n?"password":"••••••••",onBlur:h,onChange:s,isDisabled:!f||!v,isError:!!o,isFullWidth:!0,isRequired:!0,renderRightPanel:({color:d,...a})=>e(T,{...a,label:"New Password",isVisible:n,isHovering:Q,setIsVisible:C,setIsHovering:J,iconProps:{...a,skeletonColor:d}}),type:n?"text":"password",value:c})}),e(S,{control:i,name:"confirmNewPassword",render:({field:{onChange:s,onBlur:h,value:c,name:u},fieldState:{error:o}})=>e(M,{color:p,colorMode:r,autoComplete:"off",label:"Confirm Password",name:u,helper:o?o.message:void 0,placeholder:F?"password":"••••••••",onBlur:h,onChange:s,isDisabled:!f||!v,isError:!!o,isFullWidth:!0,isRequired:!0,renderRightPanel:({color:d,...a})=>e(T,{...a,label:"Confirm Password",isVisible:F,isHovering:K,setIsVisible:_,setIsHovering:ee,iconProps:{...a,skeletonColor:d}}),type:F?"text":"password",value:c})})]})]})]})}),e(ue,{children:b(pe,{width:"100%",justifyContent:"space-between",spacing:0,children:[e(z,{colorMode:r,onClick:()=>N(),variant:"outlined",children:"Back"}),e(z,{color:p,colorMode:r,isDisabled:!k,type:"submit",children:"Change Password"})]})})]})})})},x="ds-edb-authentication-reset-password-success-toast",V="ds-edb-authentication-reset-password-error-toast",De={username:"",password:"",newPassword:"",confirmNewPassword:""},ts=()=>{const H=we(),[g]=fe(`(min-width: ${H.breakpoints.lg})`),{spacing:N}=be(),p=Ce(),r=Pe(),$=ge(),i=Z(l=>l.users.data.users),t=ve(),w=Ie({defaultValues:{...De,...ye.parse(p.search)},resolver:Se(Oe)}),{control:v,reset:k}=w,{isDirty:f}=G({control:v});return $e({title:"Unsubmitted Changes!",subtitle:"Are you sure you want to cancel resetting the password? Once you close the page you will not be able to retrieve the changed data!",when:f}),b(Me,{width:"100%",height:"100vh",templateRows:"repeat(1, 1fr)",templateColumns:`repeat(${g?2:1}, 1fr)`,overflowX:"hidden",overflowY:"hidden",gap:0,children:[e(B,{overflowX:"hidden",overflowY:"auto",children:e(xe,{width:"100%",minHeight:"100vh",p:N,children:e(Re,{form:w,onSubmit:l=>{const{username:O,password:R,newPassword:D}=l,n=i.find(C=>C.data.credentials.username===O);if(n&&Y(R).toString()===n.data.credentials.password){t.isActive(x)||(t.close(V),t({id:x,duration:j({duration:15}),position:"bottom-left",render:()=>e(X,{duration:15,description:`Successfully updated ${n.data.info.name}'s password!`,status:"success",onClose:()=>t.close(x)})}));const C={...n.data.credentials,password:Y(D).toString()};$(Ve({id:n.data.id,data:{...C}})),k({...l})}else t.isActive(V)||(t.close(x),t({id:V,duration:j({duration:15}),position:"bottom-left",render:()=>e(X,{duration:15,description:"Incorrect username or password! Please try again.",status:"error",onClose:()=>t.close(V)})}))},onBack:()=>r("/authentication/signin")})})}),g&&e(B,{overflowX:"hidden",overflowY:"hidden",children:e(Ne,{width:"100%",height:"100vh",illustration:ke})})]})};export{ts as default,De as defaultValues};
