import{d6 as qe,d7 as x,d8 as He,H as E,I,dR as z,E as e,b6 as le,cW as p,b7 as Q,x as $,N as V,bI as Ce,bO as Ne,ah as Me,aQ as ve,J as Se,V as Y,as as Ge,cB as A,aj as B,ai as Oe,a7 as Pe,a9 as Re,aG as We,aI as _e,aL as Z,a6 as U,d5 as Be,dE as Le,c9 as je,U as Je,c7 as Qe,cV as X,cX as K,dI as he,ar as Ze,e5 as Xe,e6 as Ke,e7 as Ye,e8 as es,ae as ss,db as ts,ba as pe,ch as os,ci as as,e9 as T,bN as ae,cx as rs,bc as is,e4 as ns,b9 as fe}from"./useUserTheme-cad0e91d.js";import{P as ge,u as we,f as ls,l as cs,s as ds}from"./index-5536e45c.js";import{u as us}from"./usePrompt-5bc04cbc.js";import{a as ms,U as hs}from"./index-163d9a30.js";import"./index-789eed9b.js";import"./index-f91c493c.js";import"./index-8754a0a6.js";import"./index-da6fdb45.js";import"./dimensions-1922ff5f.js";import"./index-490c57f0.js";import"./index-fac269b5.js";import"./index-86281d15.js";import"./index-65752566.js";import"./index-6c03e0d3.js";import"./index-566ac3e3.js";import"./index-059dc8bd.js";import"./index-67fb8a4b.js";import"./index-278c1566.js";import"./index-5e29d59e.js";import"./tabs-1769093c.js";import"./index-c7b185ee.js";import"./index-a6d2ef26.js";import"./index-6b3e9b0b.js";import"./tabs-8cea7072.js";const ps=qe().shape({username:x().required().matches(/^[a-z0-9_-]+$/,"The username must be only in lowercase!").min(5,"The username must be at least 5 characters long!").max(20,"The username cannot exceed 20 characters!").label("Username"),newPassword:x().required().matches(/^(?=.*[A-Za-z])(?=.*\d)(?=.*[@$!%*#?&])[A-Za-z\d@$!%*#?&]{8,}$/,"Must Contain 8 Characters, One Uppercase, One Lowercase, One Number and one special case Character!").max(30,"Cannot exceed 30 chars!").label("Password"),confirmNewPassword:x().oneOf([He("newPassword")],"Confirm Password must be equal to Password!").label("Confirm Password"),firstName:x().required().max(30,"The first name cannot exceed 30 characters!").label("First name"),lastName:x().required().max(30,"The last name cannot exceed 30 characters!").label("Last name"),bio:x().label("Biography")}),D={username:"",newPassword:"",confirmNewPassword:"",firstName:"",lastName:"",bio:""},fs={movie:[],tv:[]},gs={color:E,colorMode:I},ws={avatar_path:"",background_path:""},bs=i=>{const{color:o=E,colorMode:a=I}=z(),{form:r,firstName:m,lastName:f,username:n}=i;return e(ms,{color:o,colorMode:a,form:r,firstName:m,lastName:f,username:n})},Cs=i=>{const{color:o=E,colorMode:a=I}=z();return e(hs,{...i,color:o,colorMode:a})},re=2,Ns=i=>{const o=le(u=>u.users.data.users||[]),{color:a=E,colorMode:r=I}=z(),{form:m,placeholder:f}=i,{control:n,getValues:g,clearErrors:y,setValue:w,setError:q,reset:P}=m,H=p({control:n,name:"username"}),F=p({control:n,name:"newPassword"}),d=p({control:n,name:"confirmNewPassword"}),[h,b]=Q(),[C,l]=Q(),[G,L]=Q(),[O,R]=Q(),W=()=>{P({...g(),username:D.username,newPassword:D.newPassword,confirmNewPassword:D.confirmNewPassword},{keepDirty:!0,keepDirtyValues:!0,keepErrors:!0,keepIsSubmitted:!0,keepIsValid:!0,keepSubmitCount:!0,keepTouched:!0})},ee=$.useCallback(u=>{o.every(N=>N.data.credentials.username!==u.trim())?(y("username"),w("username",u.trim(),{shouldDirty:!0})):(w("username","",{shouldDirty:!0}),q("username",{type:"custom",message:"The username must be unique! Please try another."},{shouldFocus:!0}))},[o]);return V(Ce,{colorMode:r,isFullWidth:!0,variant:"outlined",p:re,children:[e(Ne,{renderTitle:u=>e(Me,{...u,children:"Credentials"}),actions:e(ve,{color:a,colorMode:r,isDisabled:!H&&!F&&!d,onClick:()=>W(),size:"xs",variant:"text",children:"Clear"})}),e(Se,{children:V(Y,{width:"100%",divider:e(Ge,{colorMode:r}),spacing:re,children:[e(A,{control:n,name:"username",render:({field:{onBlur:u,value:N,name:M},fieldState:{error:v}})=>e(B,{color:a,colorMode:r,autoComplete:"off",label:"Username",id:M,name:M,helper:v?v.message:void 0,placeholder:f,onBlur:u,onChange:c=>ee(c.target.value),isError:!!v,isFullWidth:!0,isRequired:!0,renderLeftPanel:({color:c,...S})=>e(Oe,{...S,icon:"alternate_email",category:"outlined",skeletonColor:c}),value:N})}),V(Y,{width:"100%",spacing:re,children:[e(A,{control:n,name:"newPassword",render:({field:{onChange:u,onBlur:N,value:M,name:v},fieldState:{error:c}})=>e(B,{color:a,colorMode:r,autoComplete:"off",label:"Password",name:v,helper:c?c.message:void 0,placeholder:h?"password":"••••••••",onBlur:N,onChange:u,isError:!!c,isFullWidth:!0,isRequired:!0,renderRightPanel:({color:S,...k})=>e(ge,{...k,label:"Password",isVisible:h,isHovering:C,setIsVisible:b,setIsHovering:l,iconProps:{...k,skeletonColor:S}}),type:h?"text":"password",value:M})}),e(A,{control:n,name:"confirmNewPassword",render:({field:{onChange:u,onBlur:N,value:M,name:v},fieldState:{error:c}})=>e(B,{color:a,colorMode:r,autoComplete:"off",label:"Confirm Password",name:v,helper:c?c.message:void 0,placeholder:G?"password":"••••••••",onBlur:N,onChange:u,isError:!!c,isFullWidth:!0,isRequired:!0,renderRightPanel:({color:S,...k})=>e(ge,{...k,label:"Confirm Password",isVisible:G,isHovering:O,setIsVisible:L,setIsHovering:R,iconProps:{...k,skeletonColor:S}}),type:G?"text":"password",value:M})})]})]})})]})},Ms=i=>{const o=Pe(),[a]=Re(`(min-width: ${o.breakpoints.sm})`),{color:r=E,colorMode:m=I}=z(),{form:f,placeholder:n}=i,{control:g,getValues:y,reset:w}=f,q=p({control:g,name:"firstName"}),P=p({control:g,name:"lastName"}),H=p({control:g,name:"bio"}),F=()=>{w({...y(),firstName:D.firstName,lastName:D.lastName,bio:D.bio},{keepDirty:!0,keepDirtyValues:!0,keepErrors:!0,keepIsSubmitted:!0,keepIsValid:!0,keepSubmitCount:!0,keepTouched:!0})};return V(Ce,{colorMode:m,isFullWidth:!0,variant:"outlined",p:2,children:[e(Ne,{renderTitle:d=>e(Me,{...d,children:"Information"}),actions:e(ve,{color:r,colorMode:m,isDisabled:!q&&!P&&!H,onClick:()=>F(),size:"xs",variant:"text",children:"Clear"})}),e(Se,{children:V(Y,{width:"100%",spacing:2,children:[V(We,{width:"100%",columns:a?2:1,spacing:2,children:[e(A,{control:g,name:"firstName",render:({field:{onChange:d,onBlur:h,value:b,name:C},fieldState:{error:l}})=>e(B,{color:r,colorMode:m,autoComplete:"off",label:"First name",name:C,helper:l?l.message:void 0,placeholder:n.firstName,onBlur:h,onChange:d,isError:!!l,isFullWidth:!0,isRequired:!0,value:b})}),e(A,{control:g,name:"lastName",render:({field:{onChange:d,onBlur:h,value:b,name:C},fieldState:{error:l}})=>e(B,{color:r,colorMode:m,autoComplete:"off",label:"Last name",name:C,helper:l?l.message:void 0,placeholder:n.lastName,onBlur:h,onChange:d,isError:!!l,isFullWidth:!0,isRequired:!0,value:b})})]}),e(A,{control:g,name:"bio",render:({field:{onChange:d,onBlur:h,value:b,name:C},fieldState:{error:l}})=>e(_e,{color:r,colorMode:m,label:"Biography",name:C,helper:l?l.message:void 0,placeholder:`My name is ${n.firstName} ${n.lastName} ...`,onBlur:h,onChange:d,isError:!!l,isFullWidth:!0,value:b,sx:{textarea:{height:o.space[12.5]}}})})]})})]})},vs=i=>{const o=Z(U.sample(U.range(we.length))),a=Z(o?we[o]:"johnsmith"),r=Z(o?ls[o]:"John"),m=Z(o?cs[o]:"Smith");return V(Y,{width:"100%",spacing:4,children:[e(Ns,{...i,placeholder:a}),e(Ms,{...i,placeholder:{firstName:r,lastName:m}})]})},Ss=i=>{const{color:o=E,colorMode:a=I}=z();return e(Be,{...i,color:o,colorMode:a})},{getHue:be,getColorMode:Ps}=ss,ie="ds-edb-authentication-register-toast",ne=Le(),Vs=[{title:"Details",subtitle:"Enter your credentials and some basic information about you.",status:"active"},{title:"Favored Genres",subtitle:"Select your most favorite Movie & TV Show genres.",status:"idle"},{title:"Customization",subtitle:"Pick your favorite color and mode.",status:"idle"},{title:"Avatar & Background",subtitle:"Upload an avatar & background of your choice!",status:"idle"}],Zs=()=>{const i=Pe(),o=je(),{colorMode:a=I,setColor:r,setColorMode:m}=z(),f=Je(),n=le(s=>s.users.data.activeUser),g=le(s=>s.users.data.users||[]),y=Qe(),[w,q]=$.useState([...Vs]),[P,H]=$.useState(0),F=X({mode:"onTouched",reValidateMode:"onChange",defaultValues:D,resolver:ts(ps)}),{control:d,getValues:h,reset:b}=F,C=p({control:d,name:"firstName"}),l=p({control:d,name:"lastName"}),G=p({control:d,name:"username"}),{isValid:L,errors:O,isDirty:R}=K({control:d}),W=X({mode:"onTouched",reValidateMode:"onChange",defaultValues:fs}),{control:ee,getValues:u,reset:N}=W,{isValid:M,isDirty:v}=K({control:ee}),c=X({mode:"onTouched",reValidateMode:"onChange",defaultValues:{...gs,...n.ui.theme}}),{control:S,getValues:k,reset:Ve}=c,_=p({control:S,name:"color"}),se=p({control:S,name:"colorMode"}),{isValid:ce,isDirty:ye}=K({control:S}),de=X({mode:"onTouched",reValidateMode:"onChange",defaultValues:{...ws,avatar_path:he({id:ne,colors:U.omit({...i.colors},["transparent","black","white"]),hue:be({colorMode:a,type:"color"}),size:500,variant:"beam"}),background_path:he({id:ne,colors:U.omit({...i.colors},["transparent","black","white"]),hue:be({colorMode:a,type:"color"}),size:500,variant:"sunset"})}}),{control:Fe,getValues:ke,reset:De}=de,{isValid:ue,isDirty:Ie}=K({control:Fe});us({title:"Unsubmitted Changes!",subtitle:"Are you sure you want to cancel registration? Once you close the page you will not be able to retrieve the changed data!",when:R||v||ye||Ie});const me=$.useCallback(s=>{switch(s){case 0:{let t="idle";return L?t="success":U.isNil(O)||U.isEmpty(O)?R&&(t="warning"):t="error",t}case 1:{let t="idle";return M&&(t="success"),t}case 2:{let t="idle";return ce&&(t="success"),t}case 3:{let t="idle";return ue&&(t="success"),t}default:return"idle"}},[L,O,R,M,ce,ue]),xe=$.useCallback(s=>{switch(s){case 0:return e(vs,{form:F});case 1:return e(Cs,{form:W});case 2:return e(Ss,{form:c});case 3:return e(bs,{form:de,firstName:C,lastName:l,username:G})}},[F,W,c,_,a]),Te=$.useCallback(({index:s})=>{q(w.map((t,j)=>j===P?{...t,status:me(P)}:t)),H(s)},[w,P,me]),$e=()=>{f(pe(!0)),y.isActive(ie)||y({id:ie,duration:os({duration:15}),position:"bottom-left",render:()=>e(as,{duration:15,description:`${s.firstName} ${s.lastName} was successfully created!`,status:"success",onClose:()=>y.close(ie)})});const s=h(),t=u(),j=k(),te=ke(),Ae={name:`${s.firstName} ${s.lastName}`,bio:s.bio,avatar_path:te.avatar_path,background_path:te.background_path,prefers:{...t}},Ee={username:s.username,password:ds(s.newPassword).toString(),rememberMe:!1},J={...T,data:{...T.data,id:ne,credentials:{...T.data.credentials,...Ee},info:{...T.data.info,...Ae},signedInAt:ae().toISOString(),updatedAt:ae().toISOString(),createdAt:ae().toISOString()},ui:{...T.ui,theme:{...T.ui.theme,...j}}},ze=rs([...g.filter(oe=>oe.data.id!==J.data.id),J]).desc(oe=>oe.data.signedInAt);f(is({...J})),f(ns([...ze])),fe({color:J.ui.theme.color,colorMode:a}),b({...s}),N({...t}),Ve({...j}),De({...te}),setTimeout(()=>o("/"),500),setTimeout(()=>f(pe(!1)),2500)},Ue=()=>{const s=se==="system"?Ps():se;fe({color:_,colorMode:s}),r(_),m(s)};return Ze(()=>Ue(),[_,se]),V(Xe,{activeStep:P,color:_,colorMode:a,onChange:Te,onCancel:()=>o("/authentication/signin"),onSubmit:$e,children:[e(Ke,{children:[...w]}),e(Ye,{children:w.map((s,t)=>e(es,{...s,index:t,total:w.length,p:3,children:xe(t)},s.title))})]})};export{Zs as default};
